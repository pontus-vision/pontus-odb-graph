rules:

#    {
#      "A1_END": "sss"
#      "A1_TEL": "sss"
#      "A1_EMAIL": "sss"
#      "A1_PFISICA": "sss"
#      "A1_RG": "sss"
#      "A1_BAIRRO": "VL SAO VICENTE"
#      "A1_ESTADO": "sss"
#      "A1_CEP": "15500117"
#      "lastUpdate": "2016-08-29T09:12:33.001Z"
#      "A1_CGC": "58952390806"
#      "A1_COD_MUN": "sss"
#      "A1_NOME": "sss"
#      "id": "id"
#      "firstUpdate": "2016-08-29T09:12:33.001Z"
#      "A1_DDD": "sss"
#      "A1_EST": "sss"
#      "A1_MUN": "sss"
#    }

  totvs_protheus_sa1_clientes:
    vertices:
      - label: Person.Natural
        condition: "${A1_CGC?.replaceAll('[^0-9]','')?.length() == 11}"
        props:
          Full_Name: "${A1_NOME?.trim()?.toUpperCase()}"
#          Type:
#            val: "Clientes"
#            excludeFromSearch: true
          Customer_ID: "${A1_CGC?.replaceAll('[^0-9]','')}"

      - label: Person.Organisation
        condition: "${A1_CGC?.replaceAll('[^0-9]','')?.length() == 14}"
        props:
          Name: "${A1_NOME?.trim()?.toUpperCase()}"
#          Type:
#            val: "Clientes"
#            excludeFromSearch: true
          Id: "${A1_CGC.replaceAll('[^0-9]','')}"
          Registration_Number: "${A1_CGC.replaceAll('[^0-9]','')}"
#          Contact: "${A1_CONTATO?.trim()}"

      - label: Object.Phone_Number
        condition: "${A1_TEL?.replaceAll('[^0-9]','')?.length() > 0}"
        props:
          Raw: "${A1_TEL}"
#          Type:
#            val: "Office"
#            excludeFromSubsequenceSearch: true
          Numbers_Only:
            val: "${(A1_TEL?.replaceAll('[^0-9]', '')?:'00000000')}"
            excludeFromSearch: true
            type: "[Ljava.lang.String;"
          Last_7_Digits:
            val: "${(((A1_TEL?.replaceAll('[^0-9]', ''))?:'0000000')[-7..-1])}"
            type: "[Ljava.lang.String;"

      #RG
      - label: Object.Identity_Card
        condition: "${A1_RG?.replaceAll('[^0-9]', '')?.length() > 0}"
        name: rg
        props:
          Id_Value: "${A1_RG?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "RG"
            excludeFromSearch: true

      - label: Object.Identity_Card
        condition: "${A1_CGC?.replaceAll('[^0-9]','')?.length() == 11}"
        name: cpf
        props:
          Id_Value: "${A1_CGC?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CPF"
            excludeFromSearch: true

      - label: Object.Identity_Card
        condition: "${A1_CGC?.replaceAll('[^0-9]','')?.length() == 14}"
        name: cnpj
        props:
          Id_Value: "${A1_CGC?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CNPJ"
            excludeFromSearch: true
      # EMAIL
      - label: Object.Email_Address
        condition: "${A1_EMAIL?.trim()?.length() > 0}"
        props:
          Email: "${A1_EMAIL?.trim()?.toLowerCase()}"

      #ENDERECO,BAIRRO,CIDADE,UF,CEP
      - label: Location.Address
#        condition: "${A1_CGC?.replaceAll('[^0-9]','')?.length() == 14}"
        props:
          Full_Address:
            val: "${A1_END?.trim()?.toUpperCase()}, ${A1_BAIRRO?.trim()?.toUpperCase()}, ${A1_MUN?.trim()?.toUpperCase()} - ${A1_ESTADO?.trim()?.toUpperCase()}, ${A1_CEP}, BRASIL"
            excludeFromSearch: true
          parser:
            val: "${A1_END?.trim()?.toUpperCase()}, ${A1_BAIRRO?.trim()?.toUpperCase()}, ${A1_MUN?.trim()?.toUpperCase()} - ${A1_ESTADO?.trim()?.toUpperCase()}, ${A1_CEP}, BRASIL"
            type: "com.pontusvision.utils.LocationAddress"
          Post_Code: "${com.pontusvision.utils.PostCode.format(A1_CEP)}"
#          Type:
#            val: "Business"
#            excludeFromSearch: true

      - label: Event.Ingestion
        props:
          Type:
            val: "totvs/protheus/sa1_clientes"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${firstUpdate}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${lastUpdate}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Type: "totvs/protheus/sa1_clientes"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
#          Metadata_Start_Date:
#            val: "${new Date()}"
#            excludeFromSearch: true
#            type: java.util.Date
#          Metadata_End_Date:
#            val: "${new Date()}"
#            excludeFromSearch: true
#            type: java.util.Date

      - label: Object.Data_Source
        props:
          Name: "TOTVS/PROTHEUS/SA1_CLIENTES"
#          Type: "totvs/protheus/sa1_clientes"
#          Description: "Registros de Clientes no protheus/Totvs"

    edges:
      - label: Has_Ingestion_Event
        fromVertexLabel: "Object.Data_Source"
        toVertexLabel: "Event.Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Person.Natural"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Event.Ingestion"

      - label: Uses_Email
        fromVertexLabel: "Person.Natural"
        toVertexLabel: "Object.Email_Address"

      - label: Uses_Email
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Object.Email_Address"

      - label: Has_Id_Card
        fromVertexLabel: "Person.Natural"
        toVertexName: "rg"

      - label: Has_Id_Card
        fromVertexLabel: "Person.Natural"
        toVertexName: "cpf"

      - label: Has_Id_Card
        fromVertexLabel: "Person.Organisation"
        toVertexName: "cnpj"

      - label: Is_Located
        fromVertexLabel: "Person.Natural"
        toVertexLabel: "Location.Address"

      - label: Is_Located
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Location.Address"

      - label: Has_Phone
        fromVertexLabel: "Person.Natural"
        toVertexLabel: "Object.Phone_Number"

      - label: Has_Phone
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Object.Phone_Number"

#    {
#      "id": "string"
#      "lastUpdate": {}
#      "firstUpdate": {}
#      "RA_APELIDO": ""
#      "RA_BAIRRO": "Rua Da Ponte"
#      "RA_BITMAP": "9328"
#      "RA_BRPDH": "3"
#      "RA_CEP": "333333"
#      "RA_CEPCXPO": ""
#      "RA_CIC": "333333333"
#      "RA_CODMUN": "3333"
#      "RA_CODMUNE": "AP 33"
#      "RA_COMPLEM": ""
#      "RA_COMPLRG": ""
#      "RA_CPOSTAL": "33333-7"
#      "RA_CTDEPSA": ""
#      "RA_CTDPFGT": "2"
#      "RA_CTPCD": "11"
#      "RA_DDDCELU": ""
#      "RA_DDDFONE": "2"
#      "RA_DEFIFIS": "BRUNO.SSSS@SNOWYMOUNTAIN.COM.BR"
#      "RA_DESCSIN": "BRUNO.SSSS@HOTMAIL.COM"
#      "RA_EMAIL": "R. CONTINENTAL"
#      "RA_EMAIL2": "SP"
#      "RA_ENDEREC": ""
#      "RA_ESTADO": ""
#      "RA_FOLCERT": ""
#      "RA_HABILIT": "CONTINENTAL"
#      "RA_HABILMT": "842"
#      "RA_LIVCERT": "R"
#      "RA_LOGRDSC": "MARIA AMANDA S PAIVA SSSSS"
#      "RA_LOGRNUM": "SAO BERNARDO DO CAMP"
#      "RA_LOGRTP": "BRUNO EEEE FFFF SSSSS"
#      "RA_LOGRTPD": "BRUNO EEEE FFFF SSSSS"
# x    "RA_MAE": ""
#      "RA_MUNICIP": "993166800"
#      "RA_NOME": "10707"
# x     "RA_NOMECMP": "842"
#      "RA_NSOCIAL": ""
#      "RA_NUMCELU": ""
#      "RA_NUMCP": ""
#      "RA_NUMENDE": "0x2020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000"
#      "RA_NUMEPAS": "PAULO FRIAS FERRARI"
#      "RA_NUMINSC": ""
#      "RA_NUMRIC": "14430024193"
#      "RA_OBSDEFI": ""
#      "RA_PAI": ""
#      "RA_PAISEXN": "2"
#      "RA_PAISEXT": ""
#      "RA_PIS": ""
#      "RA_PLAPRE": "40293563686"
#      "RA_PORTDEF": "543838778"
#      "RA_RACACOR": ""
#      "RA_REGCIVI": "162"
#      "RA_REGISTR": "439"
#      "RA_RESERVI": ""
#      "RA_RG": "M"
#      "RA_RNE": ""
#      "RA_SECAO": "2"
#      "RA_SERCP": "418473460132"
#      "RA_SERVENT": "0"
# x     "RA_SEXO": "284"
#      "RA_TELEFON": ""
#      "RA_TIPENDE": ""
#      "RA_TITULOE": ""
#      "RA_TPDEFFI": ""
#      "RA_ZONASEC": ""
#    }
  totvs_protheus_ra_funcionario:
    vertices:
      - label: Person.Natural
        condition: "${RA_CIC?.replaceAll('[^0-9]','')?.length() == 11}"
        name: colaborador
        props:
          Full_Name: "${(RA_NOMECMP?.trim()?.length() > 0)?RA_NOMECMP?.trim()?.toUpperCase():RA_NOME?.trim()?.toUpperCase()}"
#          Type:
#            val: "Colaborador"
#            excludeFromSearch: true
#          Gender:
#            val: "${RA_SEXO}"
#            excludeFromSearch: true
          Customer_ID: "${RA_CIC?.replaceAll('[^0-9]','')}"

      - label: Person.Organisation
        condition: "${RA_CIC?.replaceAll('[^0-9]','')?.length() == 14}"
        props:
          Name: "${(RA_NOMECMP?.trim()?.length() > 0)?RA_NOMECMP?.trim()?.toUpperCase():RA_NOME?.trim()?.toUpperCase()}"
#          Type:
#            val: "Colaborador"
#            excludeFromSearch: true
          Id: "${RA_CIC.replaceAll('[^0-9]','')}"
          Registration_Number: "${RA_CIC.replaceAll('[^0-9]','')}"

      - label: Location.Address
        props:
          Full_Address:
            val: "${RA_ENDEREC?.trim()?.toUpperCase()} ${RA_COMPLEM?.trim()?.toUpperCase()} ${RA_CODMUN?.trim()?.toUpperCase()} ${RA_CODMUNE?.trim()?.toUpperCase()?:''}, ${RA_BAIRRO?.trim()?.toUpperCase()}, ${RA_MUNICIP?.trim()?.toUpperCase()} - ${RA_ESTADO?.trim()?.toUpperCase()}, ${RA_CEP}, ${RA_PAISEXT?.trim()?.toUpperCase()?:'BRASIL'}"
            excludeFromSearch: true
          parser:
            val: "${RA_ENDEREC?.trim()?.toUpperCase()} ${RA_COMPLEM?.trim()?.toUpperCase()} ${RA_CODMUN?.trim()?.toUpperCase()} ${RA_CODMUNE?.trim()?.toUpperCase()?:''}, ${RA_BAIRRO?.trim()?.toUpperCase()}, ${RA_MUNICIP?.trim()?.toUpperCase()} - ${RA_ESTADO?.trim()?.toUpperCase()}, ${RA_CEP}, ${RA_PAISEXT?.trim()?.toUpperCase()?:'BRASIL'}"
            type: "com.pontusvision.utils.LocationAddress"
          Post_Code: "${com.pontusvision.utils.PostCode.format(RA_CEP)}"
#          Description: "moradia principal"
#          Type:
#            val: "home"
#            excludeFromSearch: true

      - label: Person.Natural
        condition: "${RA_MAE?.trim()?.length() > 0}"
        name: mae
        props:
          Full_Name: "${RA_MAE?.trim()?.toUpperCase()}"
#          Type:
#            val: "colaborador-pais"
#            excludeFromSearch: false
#          Gender: "F"

      - label: Person.Natural
        condition: "${RA_PAI?.trim()?.length() > 0}"
        name: pai
        props:
          Full_Name: "${RA_PAI?.trim()?.toUpperCase()}"
#          Type:
#            val: "colaborador-pais"
#            excludeFromSearch: false
#          Gender: "M"

      - label: Object.Phone_Number
        condition: "${RA_TELEFON?.replaceAll('[^0-9]','')?.length() > 0}"
        props:
          Raw: "${RA_TELEFON}"
#          Type:
#            val: "Office"
#            excludeFromSubsequenceSearch: true
          Numbers_Only:
            val: "${(RA_TELEFON?.replaceAll('[^0-9]', '')?:'00000000')}"
            excludeFromSearch: true
            type: "[Ljava.lang.String;"
          Last_7_Digits:
            val: "${(((RA_TELEFON?.replaceAll('[^0-9]', ''))?:'0000000')[-7..-1])}"
            type: "[Ljava.lang.String;"

      - label: Object.Identity_Card
        condition: "${RA_RG?.replaceAll('[^0-9]','')?.length() > 0}"
        name: rg
        props:
          Id_Value: "${RA_RG?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "RG"
            excludeFromSearch: true

      - label: Object.Identity_Card
        condition: "${RA_CIC?.replaceAll('[^0-9]','')?.length() == 11}"
        name: cpf
        props:
          Id_Value: "${RA_CIC?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CPF"
            excludeFromSearch: true

      - label: Object.Identity_Card
        condition: "${RA_CIC?.replaceAll('[^0-9]','')?.length() == 14}"
        name: cnpj
        props:
          Id_Value: "${RA_CIC?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CNPJ"
            excludeFromSearch: true

      - label: Object.Email_Address
        condition: "${RA_EMAIL?.trim()?.length() > 0}"
        name: email1
        props:
          Email: "${RA_EMAIL.trim()?.toLowerCase()}"
#          Type:
#            val: "${(RA_EMAIL.trim()?.toLowerCase()?.contains('snowymountain.com.br'))?'business':'personal'}"
#            excludeFromSearch: true

      - label: Object.Email_Address
        condition: "${RA_EMAIL2?.trim()?.length() > 0}"
        name: email2
        props:
          Email: "${RA_EMAIL2?.trim()?.toLowerCase()}"
#          Type:
#            val: "${(RA_EMAIL2.trim()?.toLowerCase()?.contains('snowymountain.com.br'))?'business':'personal'}"
#            excludeFromSearch: true

      - label: Event.Ingestion
        props:
          Type:
            val: "totvs/protheus/ra_funcionario"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${firstUpdate}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${lastUpdate}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Type:
            val: "totvs/protheus/ra_funcionario"
          Operation:
            val: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
#          Metadata_Start_Date:
#            val: "${new Date()}"
#            excludeFromSearch: true
#            type: java.util.Date
#          Metadata_End_Date:
#            val: "${new Date()}"
#            excludeFromSearch: true
#            type: java.util.Date

      - label: Object.Data_Source
        props:
          Name: "TOTVS/PROTHEUS/RA_FUNCIONARIO"
#          Type: "totvs/protheus/ra_funcionario"
#          Description: "Registros de Funcionario no protheus/Totvs"

    edges:
      - label: Has_Ingestion_Event
        fromVertexLabel: "Object.Data_Source"
        toVertexLabel: "Event.Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexName: "colaborador"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Event.Ingestion"

      - label: Is_Family
        fromVertexName: "mae"
        toVertexName: "colaborador"

      - label: Is_Family
        fromVertexName: "pai"
        toVertexName: "colaborador"

      - label: Has_Phone
        fromVertexName: "colaborador"
        toVertexLabel: "Object.Phone_Number"

      - label: Has_Phone
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Object.Phone_Number"

      - label: Uses_Email
        fromVertexName: "colaborador"
        toVertexName: "email1"

      - label: Uses_Email
        fromVertexLabel: "Person.Organisation"
        toVertexName: "email1"

      - label: Uses_Email
        fromVertexName: "colaborador"
        toVertexName: "email2"

      - label: Uses_Email
        fromVertexLabel: "Person.Organisation"
        toVertexName: "email2"

      - label: Has_Id_Card
        fromVertexName: "colaborador"
        toVertexName: "rg"

      - label: Has_Id_Card
        fromVertexName: "colaborador"
        toVertexName: "cpf"

      - label: Has_Id_Card
        fromVertexLabel: "Person.Organisation"
        toVertexName: "cnpj"

      - label: Is_Located
        fromVertexName: "colaborador"
        toVertexLabel: "Location.Address"

      - label: Is_Located
        fromVertexLabel: "Person.Organisation"
        toVertexLabel: "Location.Address"

#   {
#      "id": "string"
#      "lastUpdate": {}
#      "firstUpdate": {}
#      "A2_CEP": "8560335"
#      "A2_CGC": "24984436333120"
#      "A2_COMPLEM": "NIRE 35.8.1939897-6"
#      "A2_COMPLR": ""
#      "A2_CONTATO": "JUCELINO"
#      "A2_CONTCOM": ""
#      "A2_CPFIRP": ""
#      "A2_CX_POST": ""
#      "A2_EMAIL": "jkssias@hotmail.com"
#      "A2_END": "RUA LEON PEREIRA DA COSTA"
#      "A2_ENDCOMP": ""
#      "A2_HPAGE": ""
#      "A2_LOGEX": ""
#      "A2_NEMPR": ""
#      "A2_NOME": "CLEUSA PAIVA DIA"
#      "A2_NOMFAV": ""
#      "A2_NOMRESP": "ARMS MANUTENCAO E R"
#      "A2_NREDUZ": ""
#      "A2_NR_END": ""
#      "A2_NUMEX": ""
#      "A2_PFISICA": ""
#      "A2_REPCONT": ""
#      "A2_REPRCEP": ""
#      "A2_REPRES": ""
#      "A2_REPRTEL": ""
#      "A2_REPR_EM": ""
#      "A2_REPR_EN": "98561-1525"
#      "A2_TEL": ""
#      "A2_TELRE": ""
#    }

  totvs_protheus_sa2_fornecedor:
    vertices:
      - label: Person.Organisation
        condition: "${A2_CGC?.replaceAll('[^0-9]','')?.length() == 14}"
        name: fornecedor
        props:
          Name: "${(A2_NOMRESP?.trim()?.length() > 0)?A2_NOMRESP?.trim()?.toUpperCase():A2_NOME?.trim()?.toUpperCase()}"
#          Type:
#            val: "Fornecedor"
#            excludeFromSearch: true
          Id: "${A2_CGC.replaceAll('[^0-9]','')}"
          Registration_Number: "${A2_CGC.replaceAll('[^0-9]','')}"
#          Contact: "${A2_CONTATO?.trim()}"

      - label: Person.Natural
        condition: "${A2_CGC?.replaceAll('[^0-9]','')?.length() == 11}"
        name: rep
        props:
          Full_Name: "${(A2_NOME?.trim()?.length() > 0)?A2_NOME?.trim()?.toUpperCase():A2_NOMRESP?.trim()?.toUpperCase()}"
          #          Type:
          #            val: "fornecedor"
          #            excludeFromSearch: false
          #            excludeFromSearch: true

      - label: Location.Address
        #        condition: "${A2_CGC?.replaceAll('[^0-9]','')?.length() == 14}"
        props:
          Full_Address:
            val: "${A2_END?.trim()?.toUpperCase()} ${A2_ENDCOMP?.trim()?.toUpperCase()}, ${A2_BAIRRO?.trim()?.toUpperCase()}, ${A2_MUNICIP?.trim()?.toUpperCase()} - ${A2_ESTADO?.trim()?.toUpperCase()}, ${A2_CEP}, BRASIL"
            excludeFromSearch: true
          parser:
            val: "${A2_END?.trim()?.toUpperCase()} ${A2_ENDCOMP?.trim()?.toUpperCase()}, ${A2_BAIRRO?.trim()?.toUpperCase()}, ${A2_MUNICIP?.trim()?.toUpperCase()} - ${A2_ESTADO?.trim()?.toUpperCase()}, ${A2_CEP}, BRASIL"
            type: "com.pontusvision.utils.LocationAddress"
          Post_Code: "${com.pontusvision.utils.PostCode.format(A2_CEP)}"
      #          Description: "endereco fornecedor"
      #          Type:
      #            val: "business"

      - label: Object.Identity_Card
        condition: "${A2_RG?.replaceAll('[^0-9]', '')?.length() > 0}"
        name: rg
        props:
          Id_Value: "${A2_RG?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "RG"
            excludeFromSearch: true

      - label: Object.Identity_Card
        condition: "${A2_CGC?.replaceAll('[^0-9]', '')?.length() == 14}"
        name: cnpj
        props:
          Id_Value: "${A2_CGC?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CNPJ"
            excludeFromSearch: true

      - label: Object.Identity_Card
        condition: "${A2_CGC?.replaceAll('[^0-9]','')?.length() == 11}"
        name: cpf
        props:
          Id_Value: "${A2_CGC?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CPF"
            excludeFromSearch: true

      - label: Object.Phone_Number
        condition: "${A2_REPRTEL?.replaceAll('[^0-9]','').length() > 0}"
        name: rep_phone
        props:
          Raw: "${A2_REPRTEL}"
#          Type:
#            val: "Telefone 1"
#            excludeFromSubsequenceSearch: true
          Numbers_Only:
            val: "${(A2_REPRTEL?.replaceAll('[^0-9]', '')?:'00000000')}"
            excludeFromSearch: true
            type: "[Ljava.lang.String;"
          Last_7_Digits:
            val: "${(((A2_REPRTEL?.replaceAll('[^0-9]', ''))?:'0000000')[-7..-1])}"
            type: "[Ljava.lang.String;"

      - label: Object.Phone_Number
        condition: "${A2_TEL?.replaceAll('[^0-9]','')?.length() > 0}"
        name: phone2
        props:
          Raw: "${A2_TEL}"
#          Type:
#            val: "Telefone 2"
#            excludeFromSubsequenceSearch: true
          Numbers_Only:
            val: "${(A2_TEL?.replaceAll('[^0-9]', '')?:'00000000')}"
            excludeFromSearch: true
            type: "[Ljava.lang.String;"
          Last_7_Digits:
            val: "${(((A2_TEL?.replaceAll('[^0-9]', ''))?:'0000000')[-7..-1])}"
            type: "[Ljava.lang.String;"

      - label: Object.Phone_Number
        condition: "${A2_REPR_EN?.replaceAll('[^0-9]','')?.length() > 0}"
        name: mobile
        props:
          Raw: "${A2_REPR_EN}"
#          Type:
#            val: "Mobile"
#            excludeFromSubsequenceSearch: true
          Numbers_Only:
            val: "${(A2_REPR_EN?.replaceAll('[^0-9]', '')?:'00000000')}"
            excludeFromSearch: true
            type: "[Ljava.lang.String;"
          Last_7_Digits:
            val: "${(((A2_REPR_EN?.replaceAll('[^0-9]', ''))?:'0000000')[-7..-1])}"
            type: "[Ljava.lang.String;"

      - label: Object.Email_Address
        condition: "${A2_REPR_EM?.trim()?.length() > 0}"
        name: email1
        props:
          Email: "${A2_REPR_EM?.trim()?.toLowerCase()}"

      - label: Object.Email_Address
        condition: "${A2_EMAIL?.trim()?.length() > 0}"
        name: email2
        props:
          Email: "${A2_EMAIL?.trim()?.toLowerCase()}"

      - label: Event.Ingestion
        props:
          Type:
            val: "totvs/protheus/sa2_fornecedor"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${firstUpdate}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${lastUpdate}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Type: "totvs/protheus/sa2_fornecedor"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
#          Metadata_Start_Date:
#            val: "${new Date()}"
#            excludeFromSearch: true
#            type: java.util.Date
#          Metadata_End_Date:
#            val: "${new Date()}"
#            excludeFromSearch: true
#            type: java.util.Date

      - label: Object.Data_Source
        props:
          Name: "TOTVS/PROTHEUS/SA2_FORNECEDOR"
#          Type: "totvs/protheus/sa2_fornecedor"
#          Description: "Registros de Fornecedores no protheus/Totvs"

    edges:
      - label: Has_Ingestion_Event
        fromVertexName: "fornecedor"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexName: "rep"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Object.Data_Source"
        toVertexLabel: "Event.Group_Ingestion"

      - label: Has_Phone
        fromVertexName: "rep"
        toVertexName: "rep_phone"

      - label: Has_Phone
        fromVertexName: "rep"
        toVertexName: "phone2"

      - label: Has_Phone
        fromVertexName: "rep"
        toVertexName: "mobile"

      - label: Uses_Email
        fromVertexName: "rep"
        toVertexName: "email1"

      - label: Uses_Email
        fromVertexName: "rep"
        toVertexName: "email2"

      - label: Is_Located
        fromVertexName: "rep"
        toVertexLabel: "Location.Address"

      - label: Has_Id_Card
        fromVertexName: "rep"
        toVertexName: "rg"

      - label: Has_Id_Card
        fromVertexName: "rep"
        toVertexName: "cpf"

      - label: Has_Id_Card
        fromVertexName: "fornecedor"
        toVertexName: "cnpj"

      - label: Uses_Email
        fromVertexName: "fornecedor"
        toVertexName: "email1"

      - label: Uses_Email
        fromVertexName: "fornecedor"
        toVertexName: "email2"

      - label: Has_Phone
        fromVertexName: "fornecedor"
        toVertexName: "rep_phone"

      - label: Has_Phone
        fromVertexName: "fornecedor"
        toVertexName: "phone2"

      - label: Has_Phone
        fromVertexName: "fornecedor"
        toVertexName: "mobile"

      - label: Is_Located
        fromVertexName: "fornecedor"
        toVertexLabel: "Location.Address"
