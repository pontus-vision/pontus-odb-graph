rules:

  webiny_ropa:

    vertices:

      - label: Object_Data_Source
        name: webiny
        props:
          Name: "WEBINY/MAPEAMENTO-DE-PROCESSOS"

      - label: Object_Data_Source
        name: attached_data_sources
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosLocalDeArmazenamento)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true

      - label: Object_Data_Procedures
        props:
          Form_Id: "${id}"
          ID:
            val: "${mapeamentoDeProcessosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Business_Area_Responsible:
            val: "${mapeamentoDeProcessosDepartamento?.departamentoReferencia}" # it doesn't extract the data from the array,
            excludeFromSearch: true                                             # I didn't want to create another WebinyRef just for that!
#          Type:
#            val: "${}"
#            excludeFromSearch: true
          Name:
            val: "${mapeamentoDeProcessosProcesso?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Description:
            val: "${mapeamentoDeProcessosFinalidadeDoProcesso?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Info_Collected:
            val: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosDeIdentificacaoPessoal + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosFinanceiros + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPessoais + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosPessoais + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPsicologicas + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjComposicaoFamiliar + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjInteressesDeLazer + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjAssociacoes + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProcessoJudicialAdministrativoCriminal + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosDeConsumo + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosResidenciais + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjEducacaoETreinamento + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProfissaoEEmprego + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjRegistrosGravacoesDeVideoImagemEVoz + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosBiometricos + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosSensiveis + mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjOutrosDadosPessoaisEspecificar?.outrosDadosPessoaisReferencia}"
            excludeFromSearch: true
          Type_Of_Natural_Person:
            val: "${mapeamentoDeProcessosCategoriaDosTitularesDosDados}"
            excludeFromSearch: true
#          Data_Provider:
#            val: "${}"
#            excludeFromSearch: true
#          Why_Is_It_Collected:
#            val: "${mapeamentoDeProcessosFinalidadeDoProcesso}"
#            excludeFromSearch: true
#          Secondary_Purpose_Of_Collection:
#            val: "${}"
#            excludeFromSearch: true
#          Country_Where_Stored:
#            val: "${}"
#            excludeFromSearch: true
#          Participants:
#            vals: "${}"              TODO: what to do with that ?!
#            excludeFromSearch: true
#          Info_Shared_With_Third_Parties:
#            vals: "${}"
#            excludeFromSearch: true
#          Info_Shared_With_Third_Parties_International:
#            vals: "${}"
#            excludeFromSearch: true
#          Info_Share_Justification:
#            val: "${}"              TODO: não temos campo para essa questão
#            excludeFromSearch: true
#          Info_Share_Justification_International:
#            val: "${}"
#            excludeFromSearch: true
#          Number_Of_Natural_Person:
#            val: "${}"
#            excludeFromSearch: true
          Products_And_Services:
            val: "${mapeamentoDeProcessosDadosPessoaisEstaoRelacionadosProdutosServicos?.trim()?.toUpperCase()}" # this field will change!
            excludeFromSearch: true
#          Rights:
#            val: "${}"               #TODO: Check with @Leo if it is needed into Webiny
#            excludeFromSearch: true
          Lawful_Basis_Justification:
            val: "${mapeamentoDeProcessosJustificativaDaBaseLegal?.trim()?.toUpperCase()}"
            excludeFromSearch: true

      - label: Person_Natural
        name: responsible
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosNomeDoResponsavel?.titularesCpfDoTitular)}"

      - label: Object_Lawful_Basis
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosBasesLegais)}" # try this !!
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromStringTrimUC(it,'basesLegaisReferencia')}"
            processAll: true

#      - label: Object_Contract  # ainda não tem campo no CMS Mapeamentos
#        props:
#          Registration_Number:
#            val: "${new groovy.json.JsonBuilder()}" #TODO (linkage only)
#            type: "[Ljava.lang.String;"
##            postProcessor: "${com.pontusvision.utils.SharepointRef.fromString(it)?.getLookupId()}"
#            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosDeIdentificacaoPessoal != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosDeIdentificacaoPessoal.size() > 0}"
        name: personal_identification
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosDeIdentificacaoPessoal)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosFinanceiros != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosFinanceiros.size() > 0}"
        name: financial_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosFinanceiros)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPessoais != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPessoais.size() > 0}"
        name: personal_characteristics
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPessoais)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosPessoais != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosPessoais.size() > 0}"
        name: personal_habits
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosPessoais)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPsicologicas != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPsicologicas.size() > 0}"
        name: psychological_characteristics
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjCaracteristicasPsicologicas)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjComposicaoFamiliar != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjComposicaoFamiliar.size() > 0}"
        name: family_composition
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjComposicaoFamiliar)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjInteressesDeLazer != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjInteressesDeLazer.size() > 0}"
        name: leisure_interests
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjInteressesDeLazer)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjAssociacoes != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjAssociacoes.size() > 0}"
        name: associations
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjAssociacoes)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProcessoJudicialAdministrativoCriminal != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProcessoJudicialAdministrativoCriminal.size() > 0}"
        name: criminal_processes
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProcessoJudicialAdministrativoCriminal)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosDeConsumo != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosDeConsumo.size() > 0}"
        name: consumption_habits
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjHabitosDeConsumo)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosResidenciais != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosResidenciais.size() > 0}"
        name: residential_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosResidenciais)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjEducacaoETreinamento != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjEducacaoETreinamento.size() > 0}"
        name: education_and_training
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjEducacaoETreinamento)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProfissaoEEmprego != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProfissaoEEmprego.size() > 0}"
        name: profession_and_employment
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjProfissaoEEmprego)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjRegistrosGravacoesDeVideoImagemEVoz != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjRegistrosGravacoesDeVideoImagemEVoz.size() > 0}"
        name: image_record
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjRegistrosGravacoesDeVideoImagemEVoz)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosBiometricos != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosBiometricos.size() > 0}"
        name: biometric_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosBiometricos)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosSensiveis != null && mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosSensiveis.size() > 0}"
        name: sensitive_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjDadosSensiveis)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        condition: "${mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjOutrosDadosPessoaisEspecificar != null}"
        name: other_personal_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(mapeamentoDeProcessosDadosPessoaisObj?.mapeamentoDeProcessosDadosPessoaisObjOutrosDadosPessoaisEspecificar?.outrosDadosPessoaisReferencia)}"
#            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.replaceAll('^\"|\"$', '')}"
            processAll: true

#      - label: Object_Data_Policy
#        props:
#          Form_Id: "${id}"
#          Type:
#            val: "${}"
#            excludeFromSearch: true
#          Retention_Period:
#            val: "${mapeamentoDeProcessosPeriodoDeRetencao?.periodosReferencia}"
#            excludeFromSearch: true
##          Retention_Justification:
##            val: "${}"
##            excludeFromSearch: true
#          Profiling_And_Scoring:
#            val: "${}"
#            excludeFromSearch: true
#          Uses_Automation:
#            val: "${}"
#            excludeFromSearch: true
#          Is_Updated:
#            val: "${}"
#            excludeFromSearch: true
#          Is_Deleted:
#            val: "${}"
#            excludeFromSearch: true
##          Is_Essential:
##            val: "${}"
##            excludeFromSearch: true
#          Is_Anonymized:
#            val: "${}"
#            excludeFromSearch: true

#      - label: Object_Privacy_Notice
#        condition: "${H_x00e1_informa_x00e7__x00e3_oao == 'Sim'}"
#        props:
#          Form_Id: "${id}"
#          Metadata_Update_Date:
#            val: "${Modified}"
#            type: "java.util.Date"
#            excludeFromSearch: true
#          Metadata_Create_Date:
#            val: "${Created}"
#            type: "java.util.Date"
#            excludeFromSearch: true
#          How_Is_It_Collected:
#            val: "${Comoosdadospessoaiss_x00e3_ocole}"
#            excludeFromSearch: true
#          Description:
#            val: "${Qual_x00e9_omeioadotadoparainfor}"
#            excludeFromSearch: true
#          Agreements:
#            val: "${Quaisdestesdireitospodemseratend}"
#            excludeFromSearch: true

#      - label: Event_Data_Breach
#        condition: "${Houvealgumincidentedeseguran_x00 == 'Sim'}"
#        props:
#          Form_Id: "${id}"
#          Id:
#            val: "${Title?.trim()?.toUpperCase()}"
#            excludeFromSearch: true
#          Authority_Notified:
#            val: "${ropa100=='Sim'?Fornecerosdetalhes_x002c_casopos:''}"
#            excludeFromSearch: true
#          Authority_Notified_Others:
#            val: "${ropa102=='Sim'?Emcasopositivo_x002c_fornecerosd0:''}"
#            excludeFromSearch: true
#          Metadata_Create_Date:
#            val: "${Created}"
#            type: java.util.Date
#            excludeFromSearch: true
#          Metadata_Update_Date:
#            val: "${Modified}"
#            type: java.util.Date
#            excludeFromSearch: true
#          Description:
#            val: "${Emcasopositivo_x002c_fornecerosd}"
#            excludeFromSearch: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/mapeamento-de-processos"
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/mapeamento-de-processos"
          Operation: Structured Data Insertion
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:    #TODO: fix the edges !!
      - label: "Has_Ingestion_Event"
        fromVertexName: "webiny"
        toVertexLabel: "Event_Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Data_Procedures"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "personal_identification"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "financial_data"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "personal_characteristics"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "personal_habits"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "psychological_characteristics"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "family_composition"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "leisure_interests"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "associations"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "criminal_processes"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "consumption_habits"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "residential_data"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "education_and_training"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "profession_and_employment"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "image_record"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "biometric_data"

      - label: "Has_Personal_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "other_personal_data"

      - label: "Has_Sensitive_Data"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "sensitive_data"

      - label: "Has_Data_Source"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexName: "attached_data_sources"

#      - label: "Has_Data_Policy"
#        fromVertexLabel: "Object_Data_Procedures"
#        toVertexLabel: "Object_Data_Policy"
#
#      - label: "Impacted_By_Data_Breach"
#        fromVertexLabel: "Event_Data_Breach"
#        toVertexName: "attached_data_sources"
#
#      - label: "Has_Privacy_Notice"
#        fromVertexLabel: "Object_Privacy_Notice"
#        toVertexLabel: "Object_Data_Procedures"

      - label: "Is_Responsible"
        fromVertexName: "responsible"
        toVertexLabel: "Object_Data_Procedures"

      - label: "Has_Lawful_Basis_On"
        fromVertexLabel: "Object_Data_Procedures"
        toVertexLabel: "Object_Lawful_Basis"

#      - label: "Has_Contract"
#        fromVertexLabel: "Object_Contract"
#        toVertexLabel: "Object_Data_Procedures"

  webiny_legal_actions:

    vertices:
      - label: Object_Legal_Actions
        props:
          Form_Id: "${id}"
          Description:
            val: "${acoesJudiciaisPpdReferencia?.trim()?.toUpperCase()}" #shorter
            excludeFromSearch: true
          Date:
            val: "${acoesJudiciaisPpdData}"
            type: java.util.Date
            excludeFromSearch: true
          Details:
            val: "${acoesJudiciaisPpdDescricao?.trim()?.toUpperCase()}" #longer
            excludeFromSearch: true
#          Name:
#            val: "${}"
#            excludeFromSearch: true

      - label: Object_Data_Source
        props:
          Name: "WEBINY/AÇÕES-JUDICIAIS"

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/ações-judiciais"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/ações-judiciais"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Legal_Actions"

  webiny_privacy_docs:

    vertices:
      - label: Object_Privacy_Docs
        props:
          Form_Id: "${id}"
          Description:
            val: "${comunicacoesPpdDescricao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Date:
            val: "${comunicacoesPpdData}"
            type: java.util.Date
            excludeFromSearch: true
          Title:
            val: "${comunicacoesPpdReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true

      - label: Object_Data_Source
        props:
          Name: "WEBINY/COMUNICAÇÕES-PPD"

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/comunicações-ppd"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/comunicações-ppd"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Privacy_Docs"

  webiny_meetings:

    vertices:
      - label: Event_Meeting
        props:
          Form_Id: "${id}"
          Name:
            val: "${reunioesPpdReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Title:
            val: "${reunioesPpdTituloReuniao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Date:
            val: "${reunioesPpdData}"
            type: java.util.Date
            excludeFromSearch: true
          Discussed_Topics:
            val: "${reunioesPpdTopicos?.trim()?.toUpperCase()}"
            excludeFromSearch: true

      - label: Person_Natural
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(reunioesPpdParticipantes)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'titularesCpfDoTitular')}"
            processAll: true

      - label: Object_Data_Source
        props:
          Name: "WEBINY/REUNIÕES-PPD"

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/reuniões-ppd"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/reuniões-ppd"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Event_Meeting"

      - label: Is_Participant
        fromVertexLabel: "Person_Natural"
        toVertexLabel: "Event_Meeting"

  webiny_privacy_notice:

    vertices:
      - label: Object_Privacy_Notice
        props:
          Form_Id: "${id}"
          Name:
            val: "${avisoDePrivacidadeReferencia?.trim()?.toUpperCase()}" #OR Id?
            excludeFromSearch: true
          Description:
            val: "${avisoDePrivacidadeAvisoDePrivacidade?.trim()?.toUpperCase()}"
            excludeFromSearch: true
#          Metadata_Create_Date:
#            val: "${}"
#            excludeFromSearch: true
#            type: java.util.Date
#          Metadata_Update_Date:
#            val: "${}"
#            excludeFromSearch: true
#            type: java.util.Date
          Delivery_Date:
            val: "${avisoDePrivacidadeDataDeInicio}"
            excludeFromSearch: true
            type: java.util.Date
#          Text:
#          Id:
#          Info_Collected:
#          How_Is_It_Collected:
#          How_Will_It_Be_Used:
#          Why_Is_It_Collected:

      - label: Object_Data_Source
        props:
          Name: "WEBINY/AVISO-DE-PRIVACIDADE"

      - label: Object_Data_Procedures
        condition: "${avisoDePrivacidadeIdDoProcesso?.id?.length() > 0}"
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(avisoDePrivacidadeIdDoProcesso)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it, 'id')}"
            processAll: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/aviso-de-privacidade"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/aviso-de-privacidade"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Privacy_Notice"

      - label: Has_RoPA_Privacy_Notice
        fromVertexLabel: "Object_Data_Procedures"
        toVertexLabel: "Object_Privacy_Notice"

  webiny_data_source:

    #{
    #  listFontesDeDados{
    #    data{
    #      id
    #      createdOn
    #      savedOn
    #      fontesDeDadosReferencia
    #      fontesDeDadosDescricao
    #      fontesDeDadosSistema{
    #        sistemaReferencia
    #      }
    #      fontesDeDadosSubSistema{
    #        subsistemaReferencia
    #      }
    #      fontesDeDadosModulo{
    #        moduloReferencia
    #      }
    #      fontesDeDadosPeriodoDeRetencao{
    #        periodosReferencia
    #      }
    #      fontesDeDadosFrequenciaDeAtualizacao{
    #        periodosReferencia
    #      }
    #      fontesDeDadosRiscosDeFontesDeDados{
    #        riscosDeFontesDeDadosReferencia
    #      }
    #      fontesDeDadosDadosPessoaisObj{
    #        fontesDeDadosDadosPessoaisObjOutrosDadosPessoaisEspecificar{
    #          outrosDadosPessoaisReferencia
    #        }
    #        fontesDeDadosDadosPessoaisObjDadosBiometricos
    #        fontesDeDadosDadosPessoaisObjDadosSensiveis
    #        fontesDeDadosDadosPessoaisObjRegistrosGravacoesDeVideoImagemEVoz
    #        fontesDeDadosDadosPessoaisObjProfissaoEEmprego
    #        fontesDeDadosDadosPessoaisObjEducacaoETreinamento
    #        fontesDeDadosDadosPessoaisObjDadosResidenciais
    #        fontesDeDadosDadosPessoaisObjHabitosDeConsumo
    #        fontesDeDadosDadosPessoaisObjProcessoJudicialAdministrativoCriminal
    #        fontesDeDadosDadosPessoaisObjAssociacoes
    #        fontesDeDadosDadosPessoaisObjInteressesDeLazer
    #        fontesDeDadosDadosPessoaisObjComposicaoFamiliar
    #        fontesDeDadosDadosPessoaisObjCaracteristicasPsicologicas
    #        fontesDeDadosDadosPessoaisObjHabitosPessoais
    #        fontesDeDadosDadosPessoaisObjCaracteristicasPessoais
    #        fontesDeDadosDadosPessoaisObjDadosFinanceiros
    #        fontesDeDadosDadosPessoaisObjDadosDeIdentificacaoPessoal
    #      }
    #    }
    #  }
    #}

    vertices:
      - label: Object_Data_Source
        name: webiny
        props:
          Name: "WEBINY/FONTES-DE-DADOS"

      - label: Object_Data_Source
#        condition: "${id?.trim()?.length() > 0}" TODO: add conditions ?!?!
        name: fontes_de_dados
        props:
          Form_Id: "${id}"
          Name:
            val: "${fontesDeDadosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Description:
            val: "${fontesDeDadosDescricao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
#          TODO: Keep consistency ... upperCase, lowerCase, trim, etc
          Engine:
            val: "${fontesDeDadosSistema?.sistemaReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Type:
            val: "${fontesDeDadosSubSistema?.subsistemaReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Domain:
            val: "${fontesDeDadosModulo?.moduloReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true

      - label: Object_System
        props:
          Name: "${fontesDeDadosSistema?.sistemaReferencia?.trim()?.toUpperCase()}"

      - label: Object_Subsystem
        props:
          Name: "${fontesDeDadosSubSistema?.subsistemaReferencia?.trim()?.toUpperCase()}"

      - label: Object_Module
        props:
          Name: "${fontesDeDadosModulo?.moduloReferencia?.trim()?.toLowerCase()}"

      - label: Object_Sensitive_Data
        name: personal_identification
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjDadosDeIdentificacaoPessoal)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: financial_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjDadosFinanceiros)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: personal_characteristics
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjCaracteristicasPessoais)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: personal_habits
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjHabitosPessoais)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: psychological_characteristics
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjCaracteristicasPsicologicas)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: family_composition
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjComposicaoFamiliar)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: leisure_interests
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjInteressesDeLazer)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: associations
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjAssociacoes)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: criminal_processes
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjProcessoJudicialAdministrativoCriminal)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: consumption_habits
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjHabitosDeConsumo)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: residential_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjDadosResidenciais)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: education_and_training
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjEducacaoETreinamento)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: profession_and_employment
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjProfissaoEEmprego)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: image_record
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjRegistrosGravacoesDeVideoImagemEVoz)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: biometric_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjDadosBiometricos)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: sensitive_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjDadosSensiveis)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object_Sensitive_Data
        name: other_personal_data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(fontesDeDadosDadosPessoaisObj?.fontesDeDadosDadosPessoaisObjOutrosDadosPessoaisEspecificar?.outrosDadosPessoaisReferencia)}"
            type: "[Ljava.lang.String;"
            postProcessor: "${it?.toUpperCase()}"
            processAll: true

      - label: Object_Data_Policy
        props:
          Update_Frequency: "${fontesDeDadosFrequenciaDeAtualizacao?.periodosReferencia}"
          Retention_Period: "${fontesDeDadosPeriodoDeRetencao?.periodosReferencia}"
#          Type: "${fontesDeDadosReferencia?.trim()?.toUpperCase()}"

#     TODO: não utilizamos Riscos De Fontes De Dados !!!

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/fontes-de-dados"
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/fontes-de-dados"
          Operation: Structured Data Insertion
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "webiny"
        toVertexLabel: "Event_Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Ingestion"
        toVertexName: "fontes_de_dados"

      - label: "Has_Policy"
        fromVertexName: "fontes_de_dados"
        toVertexLabel: "Object_Data_Policy"

      - label: "Has_Module"
        fromVertexName: "fontes_de_dados"
        toVertexLabel: "Object_Module"

      - label: "Has_Subsystem"
        fromVertexLabel: "Object_Module"
        toVertexLabel: "Object_Subsystem"

      - label: "Has_System"
        fromVertexLabel: "Object_Subsystem"
        toVertexLabel: "Object_System"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "personal_identification"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "financial_data"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "personal_characteristics"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "personal_habits"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "psychological_characteristics"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "family_composition"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "leisure_interests"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "associations"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "criminal_processes"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "consumption_habits"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "residential_data"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "education_and_training"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "profession_and_employment"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "image_record"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "biometric_data"

      - label: "Has_Personal_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "other_personal_data"

      - label: "Has_Sensitive_Data"
        fromVertexName: "fontes_de_dados"
        toVertexName: "sensitive_data"
        
  webiny_consents:

    vertices:
      - label: Event_Consent
        props:
          Form_Id: "${id}"
          Customer_ID:
            val: "${consentimentosIdentificacao?.replaceAll('[^0-9]', '')?.trim()}"
            excludeFromSearch: true
          Status:
            val: "\"${(consentimentosStatus?.toString()?.equalsIgnoreCase('yes') || consentimentosStatus?.toString()?.equalsIgnoreCase('true') || consentimentosStatus?.toString()?.equalsIgnoreCase('sim')) ? 'Consent': 'No Consent' }\""
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${consentimentosData}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date
          Description:
            val: "${consentimentosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true

      - label: Object_Privacy_Notice
        condition: "${consentimentosAvisoDePrivacidade?.size() > 0}"
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(consentimentosAvisoDePrivacidade)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it, 'id')}"
            processAll: true

      - label: Person_Natural
        condition: "${consentimentosTitularDoDadoPessoal?.size() > 0}"
        name: titular
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(consentimentosTitularDoDadoPessoal)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true
          Last_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Person_Natural
        condition: "${consentimentosResponsavelPeloMenor?.size() > 0}"
        name: guardian
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(consentimentosResponsavelPeloMenor)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true
          Last_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Object_Data_Source
        props:
          Name: "WEBINY/CONSENTIMENTOS"

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/consentimentos"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/consentimentos"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexName: "titular"

      - label: Consent
        fromVertexName: "titular"
        toVertexLabel: "Event_Consent"

      - label: Has_Privacy_Notice
        fromVertexLabel: "Event_Consent"
        toVertexLabel: "Object_Privacy_Notice"

      - label: Has_Parent_Or_Guardian
        fromVertexName: "titular"
        toVertexName: "guardian"

  webiny_contracts:

    vertices:

      - label: Person_Natural
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(contratosContratoAprovado)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'titularesCpfDoTitular')}"
            processAll: true

      - label: Person_Organisation
        condition: "${contratosOrganizacaoContratante?.size() > 0}"
        name: pj_contratante
        props:
          Id:
            val: "${new groovy.json.JsonBuilder(contratosOrganizacaoContratante)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true
          Registration_Number:
            val: "${new groovy.json.JsonBuilder(contratosOrganizacaoContratante)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true

      - label: Person_Organisation
        condition: "${contratosOrganizacaoContratada?.size() > 0}"
        name: pj_contratada
        props:
          Id:
            val: "${new groovy.json.JsonBuilder(contratosOrganizacaoContratada)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true
          Registration_Number:
            val: "${new groovy.json.JsonBuilder(contratosOrganizacaoContratada)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true

      - label: Person_Organisation
        condition: "${contratosOperador?.size() > 0}"
        name: operador
        props:
          Id:
            val: "${new groovy.json.JsonBuilder(contratosOperador)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true
          Registration_Number:
            val: "${new groovy.json.JsonBuilder(contratosOperador)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true

      - label: Person_Organisation
        condition: "${contratosControlador?.size() > 0}"
        name: controlador
        props:
          Id:
            val: "${new groovy.json.JsonBuilder(contratosControlador)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true
          Registration_Number:
            val: "${new groovy.json.JsonBuilder(contratosControlador)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'organizacoesCnpj')}"
            processAll: true

      - label: Object_Contract
        props:
          Form_Id: "${id}"
          #          Type:
          #          Description:
          Short_Description:
            val: "${contratosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          #          Date:
          #          Status:
          Link:
            val: "${contratosLinkDoContrato?.trim()?.toLowerCase()}"
            excludeFromSearch: true
          Expiry:
            val: "${contratosVigencia}"
            excludeFromSearch: true
            type: java.util.Date
          Tranfer_Intl:
            val: "${new groovy.json.JsonBuilder(contratosTransferenciaInternacionalDeDados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromStringTrimUC(it,'transferenciasInternacionaisInciso')}"
            processAll: true
            excludeFromSearch: true
          Country:
            val: "${contratosTransferenciaParaQualPais?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Has_Minors_Data:
#           or simply ${contratosDadosdeCriancasEAdolescentes}
            val: "\"${(contratosDadosdeCriancasEAdolescentes?.toString()?.equalsIgnoreCase('yes') || contratosDadosdeCriancasEAdolescentes?.toString()?.equalsIgnoreCase('true') || contratosDadosdeCriancasEAdolescentes?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true

      - label: Object_Data_Procedures
        condition: "${contratosRefDoProcesso?.size() > 0}"
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(contratosRefDoProcesso)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it, 'id')}"
            processAll: true

      - label: Object_Data_Source
        name: webiny
        props:
          Name: "WEBINY/CONTRATOS"

      - label: Object_Data_Source
        condition: "${contratosRefDaFonteDeDados?.size() > 0}"
        name: attached_data_sources
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(contratosRefDaFonteDeDados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/contratos"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/contratos"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexName: "webiny"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Contract"

      - label: Is_Promisee
        fromVertexName: "pj_contratante"
        toVertexLabel: "Object_Contract"

      - label: Is_Promisor
        fromVertexName: "pj_contratada"
        toVertexLabel: "Object_Contract"

      - label: Is_Data_Processor
        fromVertexName: "operador"
        toVertexLabel: "Object_Contract"

      - label: Is_Data_Controller
        fromVertexName: "controlador"
        toVertexLabel: "Object_Contract"

      - label: Has_Approved_Contract
        fromVertexLabel: "Person_Natural"
        toVertexLabel: "Object_Contract"

      - label: Has_Contract
        fromVertexLabel: "Object_Contract"
        toVertexLabel: "Object_Data_Procedures"

      - label: Has_Data_Source
        fromVertexLabel: "Object_Contract"
        toVertexName: "attached_data_sources"

  webiny_organisation:

#    {
#      listOrganizacoes{
#      data{
#      id
#      createdOn
#      savedOn
#      organizacoesEmail
#      organizacoesCnpj
#      organizacoesNome
#      organizacoesMatriz{
#      organizacoesCnpj
#    }
#      organizacoesTelefone
#      organizacoesSite
#      organizacoesEnderecoObj{
#      organizacoesEnderecoObjEndereco
#      organizacoesEnderecoObjComplemento
#      organizacoesEnderecoObjNumero
#      organizacoesEnderecoObjBairro
#      organizacoesEnderecoObjCep
#      organizacoesEnderecoObjUf
#      organizacoesEnderecoObjCidade
#    }
#    }
#    }
#    }

    vertices:

      - label: Person_Organisation
        condition: "${organizacoesCnpj?.replaceAll('[^0-9]','')?.length() == 14}"
        name: pj_national
        props:
          URL:
            val: "${organizacoesSite?.trim()?.toLowerCase()}"
            excludeFromSearch: true
          Name:
            val: "${organizacoesNome?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Id: "${organizacoesCnpj.replaceAll('[^0-9]','')}"
          Registration_Number: "${organizacoesCnpj.replaceAll('[^0-9]','')}"
          Last_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: "NATIONAL"
            excludeFromSearch: true

      - label: Person_Organisation
        condition: "${organizacoesCnpj?.replaceAll('[^0-9]','')?.length() > 0 && organizacoesCnpj?.replaceAll('[^0-9]','')?.length() != 14}"
        name: pj_international
        props:
          URL:
            val: "${organizacoesSite?.trim()?.toLowerCase()}"
            excludeFromSearch: true
          Name:
            val: "${organizacoesNome?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Id: "${organizacoesCnpj.replaceAll('[^0-9]','')}"
          Registration_Number: "${organizacoesCnpj.replaceAll('[^0-9]','')}"
          Last_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: "INTERNATIONAL"
            excludeFromSearch: true

      - label: Object_Identity_Card
        condition: "${organizacoesCnpj?.replaceAll('[^0-9]', '')?.length() == 14}"
        name: id_national
        props:
          Id_Value: "${organizacoesCnpj?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "CNPJ"
            excludeFromSearch: true

      - label: Object_Identity_Card
        condition: "${organizacoesCnpj?.replaceAll('[^0-9]', '')?.length() > 0 && organizacoesCnpj?.replaceAll('[^0-9]', '')?.length() != 14}"
        name: id_international
        props:
          Id_Value: "${organizacoesCnpj?.replaceAll('[^0-9]','')}"
          Id_Type:
            val: "INTERNATIONAL"
            excludeFromSearch: true

      - label: Object_Email_Address
        condition: "${organizacoesEmail?.trim()?.length() > 0}"
        props:
          Email: "${organizacoesEmail?.trim()?.toLowerCase()}"

      - label: Object_Phone_Number
        condition: "${organizacoesTelefone?.replaceAll('[^0-9]','')?.length() > 0}"
        props:
          Raw:
            val: "${organizacoesTelefone}"
            excludeFromSearch: true
          Numbers_Only:
            val: "${(organizacoesTelefone?.replaceAll('[^0-9]', '')?:'00000000')}"
            excludeFromSearch: true
            type: "[Ljava.lang.String;"
          Last_7_Digits:
            val: "${(((organizacoesTelefone?.replaceAll('[^0-9]', ''))?.length()>=7?(organizacoesTelefone?.replaceAll('[^0-9]', '')):'0000000')[-7..-1])}"
            type: "[Ljava.lang.String;"

      - label: Object_Data_Source
        props:
          Name: "WEBINY/ORGANIZAÇÕES"

      - label: Location_Address
        props:
          Full_Address:
            val: "${com.pontusvision.utils.LocationAddress.formatAddress(organizacoesEnderecoObj?.organizacoesEnderecoObjEndereco, organizacoesEnderecoObj?.organizacoesEnderecoObjNumero, organizacoesEnderecoObj?.organizacoesEnderecoObjComplemento, organizacoesEnderecoObj?.organizacoesEnderecoObjBairro, organizacoesEnderecoObj?.organizacoesEnderecoObjCidade,(organizacoesEnderecoObj?.organizacoesEnderecoObjUf!='Exterior')?organizacoesEnderecoObj?.organizacoesEnderecoObjUf:'', (organizacoesEnderecoObj?.organizacoesEnderecoObjUf=='Exterior')?'EXTERIOR':'BRASIL', organizacoesEnderecoObj?.organizacoesEnderecoObjCep)}"
            excludeFromSearch: true
          parser:
            val: "${com.pontusvision.utils.LocationAddress.formatAddress(organizacoesEnderecoObj?.organizacoesEnderecoObjEndereco, organizacoesEnderecoObj?.organizacoesEnderecoObjNumero, organizacoesEnderecoObj?.organizacoesEnderecoObjComplemento, organizacoesEnderecoObj?.organizacoesEnderecoObjBairro, organizacoesEnderecoObj?.organizacoesEnderecoObjCidade, (organizacoesEnderecoObj?.organizacoesEnderecoObjUf!='Exterior')?organizacoesEnderecoObj?.organizacoesEnderecoObjUf:'', (organizacoesEnderecoObj?.organizacoesEnderecoObjUf=='Exterior')?'EXTERIOR':'BRASIL', organizacoesEnderecoObj?.organizacoesEnderecoObjCep)}"
            type: "com.pontusvision.utils.LocationAddress"
          Post_Code: "${com.pontusvision.utils.PostCode.format(organizacoesEnderecoObj?.organizacoesEnderecoObjCep)}"

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/organizações"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/organizações"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:
      - label: Has_Ingestion_Event
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexName: "pj_national"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexName: "pj_international"

      - label: Has_Id_Card
        fromVertexName: "pj_national"
        toVertexName: "id_national"

      - label: Has_Id_Card
        fromVertexName: "pj_international"
        toVertexName: "id_international"

      - label: Is_Located
        fromVertexName: "pj_national"
        toVertexLabel: "Location_Address"

      - label: Is_Located
        fromVertexName: "pj_international"
        toVertexLabel: "Location_Address"

      - label: Uses_Email
        fromVertexName: "pj_national"
        toVertexLabel: "Object_Email_Address"

      - label: Uses_Email
        fromVertexName: "pj_international"
        toVertexLabel: "Object_Email_Address"

      - label: Has_Phone
        fromVertexName: "pj_national"
        toVertexLabel: "Object_Phone_Number"

      - label: Has_Phone
        fromVertexName: "pj_international"
        toVertexLabel: "Object_Phone_Number"

  webiny_awareness_campaign:

    #    {
    #      listTreinamentos{
    #      data{
    #      id
    #      createdOn
    #      savedOn
    #      treinamentosReferencia
    #      treinamentosDescricao
    #      treinamentosHorasTreinamento
    #      treinamentosRealizadoEm
    #      treinamentosParticipantesAprovados{
    #      titularesCpfDoTitular
    #    }
    #      treinamentosParticipantesReprovados{
    #      titularesCpfDoTitular
    #    }
    #    }
    #    }
    #    }
    vertices:

      - label: Person_Natural
        condition: "${treinamentosParticipantesAprovados.size() > 0}"
        name: approved
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(treinamentosParticipantesAprovados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'titularesCpfDoTitular')}"
            processAll: true

      - label: Person_Natural
        condition: "${treinamentosParticipantesReprovados.size() > 0}"
        name: failed
        props:
          Customer_ID:
            val: "${new groovy.json.JsonBuilder(treinamentosParticipantesReprovados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'titularesCpfDoTitular')}"
            processAll: true

      - label: Object_Awareness_Campaign
        props:
          Form_Id: "${id}"
          Description:
            val: "${treinamentosDescricao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Start_Date:
            val: "${treinamentosRealizadoEm}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Object_Data_Source
        props:
          Name: "WEBINY/TREINAMENTOS"

      - label: Event_Training               # TODO: VERIFICAR COM LEO SE ELIMINAREMOS
        props:
          Form_Id: "${id}"
#          Status:
#            val: "${status}"
#            excludeFromSearch: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/treinamentos"
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/treinamentos"
          Operation: Structured Data Insertion
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:
      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Object_Data_Source"
        toVertexLabel: "Event_Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Event_Training"

      - label: "Course_Training"
        fromVertexLabel: "Event_Training"
        toVertexLabel: "Object_Awareness_Campaign"

      - label: "Completed_By"
        fromVertexLabel: "Event_Training"
        toVertexName: "approved"

      - label: "Completed_By"
        fromVertexLabel: "Event_Training"
        toVertexName: "failed"

  webiny_data_breaches:

#    {
#      listIncidentesDeSegurancaReportados{
#      data{
#      id
#      createdOn
#      savedOn
#      incidentesDeSegurancaReportadosReferencia
#      incidentesDeSegurancaReportadosOrigem
#      incidentesDeSegurancaReportadosDescricao
#      incidentesDeSegurancaReportadosFontesDeDados{
#      id
#    }
#      incidentesDeSegurancaReportadosImpacto
#      incidentesDeSegurancaReportadosStatus
#      incidentesDeSegurancaReportadosNotificacaoTitular
#      incidentesDeSegurancaReportadosNotificacaoAnpd
#    }
#    }
#    }

    vertices:

      - label: Object_Data_Source
        name: webiny
        props:
          Name: "WEBINY/INCIDENTES-DE-SEGURANÇA-REPORTADOS"

      - label: Object_Data_Source
        name: data_sources
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(incidentesDeSegurancaReportadosFontesDeDados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true

      - label: Event_Data_Breach
        props:
          Form_Id: "${id}"
          Id:
            val: "${incidentesDeSegurancaReportadosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Authority_Notified:
            val: "\"${(incidentesDeSegurancaReportadosNotificacaoAnpd?.toString()?.equalsIgnoreCase('yes') || incidentesDeSegurancaReportadosNotificacaoAnpd?.toString()?.equalsIgnoreCase('true') || incidentesDeSegurancaReportadosNotificacaoAnpd?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true
          Description:
            val: "${incidentesDeSegurancaReportadosDescricao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Impact:
            val: "${incidentesDeSegurancaReportadosImpacto}"  # raw because it is used internally for scoring
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            type: java.util.Date
            excludeFromSearch: true
          Metadata_Update_Date:
            val: "${savedOn}"
            type: java.util.Date
            excludeFromSearch: true
          Natural_Person_Notified:
            val: "\"${(incidentesDeSegurancaReportadosNotificacaoTitular?.toString()?.equalsIgnoreCase('yes') || incidentesDeSegurancaReportadosNotificacaoTitular?.toString()?.equalsIgnoreCase('true') || incidentesDeSegurancaReportadosNotificacaoTitular?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true
          Source:
            val: "${incidentesDeSegurancaReportadosOrigem?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Status:
            val: "${incidentesDeSegurancaReportadosStatus}"  # raw because it is used internally for scoring
            excludeFromSearch: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/incidentes-de-segurança-reportados"
            excludeFromSearch: true
          Operation:
            val: "Structured Data Insertion"
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/incidentes-de-segurança-reportados"
          Operation: "Structured Data Insertion"
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:

      - label: Has_Ingestion_Event
        fromVertexName: "webiny"
        toVertexLabel: "Event_Group_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: Has_Ingestion_Event
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Event_Data_Breach"

      - label: Impacted_By_Data_Breach
        fromVertexLabel: "Event_Data_Breach"
        toVertexName: "data_sources"

  webiny_risk:

#    {
#      listRiscosDeFontesDeDados{
#      data{
#      id
#      createdOn
#      savedOn
#      riscosDeFontesDeDadosReferencia
#      riscosDeFontesDeDadosDescricao
#      riscosDeFontesDeDadosFontesDeDados{
#      id
#    }
#      riscosDeFontesDeDadosMitigacoesDeRiscos{
#      id
#    }
#      riscosDeFontesDeDadosAprovadoPelaSeguranca
#      riscosDeFontesDeDadosAprovadoPeloEncarregado
#      riscosDeFontesDeDadosProbabilidade
#      riscosDeFontesDeDadosProbResidual
#      riscosDeFontesDeDadosImpacto
#      riscosDeFontesDeDadosImpResidual
#
#    }
#    }
#    }

    vertices:

      - label: Object_Data_Source
        name: webiny
        props:
          Name: "WEBINY/RISCOS-DE-FONTES-DE-DADOS"

      - label: Object_Data_Source
        condition: "${riscosDeFontesDeDadosFontesDeDados?.size() > 0}"
        name: attached_data_sources
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(riscosDeFontesDeDadosFontesDeDados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true

      - label: Object_Risk_Data_Source
        props:
          Form_Id: "${id}"
          Risk_Id:
            val: "${riscosDeFontesDeDadosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Description:
            val: "${riscosDeFontesDeDadosDescricao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Probability:
            val: "${riscosDeFontesDeDadosProbabilidade}"
            excludeFromSearch: true
          Impact:
            val: "${riscosDeFontesDeDadosImpacto}"
            excludeFromSearch: true
          Residual_Probability:
            val: "${riscosDeFontesDeDadosProbResidual}"
            excludeFromSearch: true
          Residual_Impact:
            val: "${riscosDeFontesDeDadosImpResidual}"
            excludeFromSearch: true
          Approved_By_DPO:
            val: "\"${(riscosDeFontesDeDadosAprovadoPeloEncarregado?.toString()?.equalsIgnoreCase('yes') || riscosDeFontesDeDadosAprovadoPeloEncarregado?.toString()?.equalsIgnoreCase('true') || riscosDeFontesDeDadosAprovadoPeloEncarregado?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true
          Approved_By_Security:
            val: "\"${(riscosDeFontesDeDadosAprovadoPelaSeguranca?.toString()?.equalsIgnoreCase('yes') || riscosDeFontesDeDadosAprovadoPelaSeguranca?.toString()?.equalsIgnoreCase('true') || riscosDeFontesDeDadosAprovadoPelaSeguranca?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true

      - label: Object_Risk_Mitigation_Data_Source
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(riscosDeFontesDeDadosMitigacoesDeRiscos)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/riscos-de-fontes-de-dados"
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/riscos-de-fontes-de-dados"
          Operation: Structured Data Insertion
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "webiny"
        toVertexLabel: "Event_Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Risk_Data_Source"

      - label: "Has_Risk"
        fromVertexName: "attached_data_sources"
        toVertexLabel: "Object_Risk_Data_Source"

      - label: "Mitigates_Risk"
        fromVertexLabel: "Object_Risk_Mitigation_Data_Source"
        toVertexLabel: "Object_Risk_Data_Source"

  webiny_risk_mitigation:

#    {
#      listMitigacoesDeRiscos{
#      data{
#      id
#      createdOn
#      savedOn
#      mitigacoesDeRiscosReferencia
#      mitigacoesDeRiscosDescricao
#      mitigacoesDeRiscosImplementado
#      mitigacoesDeRiscosAprovado
#      mitigacoesDeRiscosRiscosDeFontesDeDados{
#      id
#    }
#    }
#    }
#    }

    vertices:

      - label: Object_Data_Source
        name: webiny
        props:
          Name: "WEBINY/MITIGAÇÕES-DE-RISCOS"

      - label: Object_Risk_Data_Source
        props:
          Form_Id:
            val: "${new groovy.json.JsonBuilder(mitigacoesDeRiscosRiscosDeFontesDeDados)}"
            type: "[Lcom.pontusvision.utils.WebinyRef;"
            postProcessor: "${com.pontusvision.utils.WebinyRef.fromString(it,'id')}"
            processAll: true

      - label: Object_Risk_Mitigation_Data_Source
        props:
          Form_Id: "${id}"
          Mitigation_Id:
            val: "${mitigacoesDeRiscosReferencia?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Description:
            val: "${mitigacoesDeRiscosDescricao?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Is_Implemented:
            val: "\"${(mitigacoesDeRiscosImplementado?.toString()?.equalsIgnoreCase('yes') || mitigacoesDeRiscosImplementado?.toString()?.equalsIgnoreCase('true') || mitigacoesDeRiscosImplementado?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true
          Is_Approved:
            val: "\"${(mitigacoesDeRiscosAprovado?.toString()?.equalsIgnoreCase('yes') || mitigacoesDeRiscosAprovado?.toString()?.equalsIgnoreCase('true') || mitigacoesDeRiscosAprovado?.toString()?.equalsIgnoreCase('sim')) ? 'True': 'False' }\""
            excludeFromSearch: true

      - label: Event_Ingestion
        props:
          Type:
            val: "webiny/mitigações-de-riscos"
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${createdOn}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${savedOn}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event_Group_Ingestion
        props:
          Type: "webiny/mitigações-de-riscos"
          Operation: Structured Data Insertion
          Ingestion_Date: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"

    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "webiny"
        toVertexLabel: "Event_Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Group_Ingestion"
        toVertexLabel: "Event_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event_Ingestion"
        toVertexLabel: "Object_Risk_Mitigation_Data_Source"

      - label: "Mitigates_Risk"
        fromVertexLabel: "Object_Risk_Mitigation_Data_Source"
        toVertexLabel: "Object_Risk_Data_Source"
